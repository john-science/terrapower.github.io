

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4. User Guide &mdash; ARMI-DIF3D Plugin 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx-needs/libs/html/datatables.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx-needs\common.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx-needs\layouts.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx-needs\modern.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx-needs\styles.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx-needs/libs/html/datatables.min.js"></script>
        <script src="_static/sphinx-needs/libs/html/datatables_loader.js"></script>
        <script src="_static/sphinx-needs/libs/html/sphinx_needs_collapse.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Requirements" href="design.html" />
    <link rel="prev" title="1. Attribution" href="summary.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ARMI-DIF3D Plugin
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="summary.html">1. Attribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html#executive-summary">2. Executive Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html#introduction">3. Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">4.1. Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">4.1.1. Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-code">4.1.2. Installing the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external-physics-codes">4.1.3. External physics codes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-test-suite">4.2. Running the test suite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unit-tests">4.2.1. Unit tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#user-settings">4.3. User settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-data">4.4. Input Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-data">4.5. Output Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#core-parameters">4.5.1. Core parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#block-parameters">4.5.2. Block parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="design.html">5. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">6. Implementation and Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">7. Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">8. Test Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">9. Apache License</a></li>
<li class="toctree-l1"><a class="reference internal" href=".apidocs/armicontrib.dif3d.html">10. API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="demodocs/modules.html">11. Demonstration Application Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ARMI-DIF3D Plugin</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">4. </span>User Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/user.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-guide">
<h1><span class="section-number">4. </span>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<p>This section describes the installation and use of the DIF3D ARMI plugin and its demo
application.</p>
<div class="section" id="installation">
<h2><span class="section-number">4.1. </span>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Installation of ARMI plugins involves configuring the plugin package and its dependencies
to be importable from a Python environment. This often involves creating a Python virtual
environment and installing the package using the <code class="docutils literal notranslate"><span class="pre">pip</span></code> Python package manager, though
other options may be acceptable depending on the user’s environment.  In this section, the
recommended installation instructions are provided.</p>
<div class="section" id="prerequisites">
<h3><span class="section-number">4.1.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>The DIF3D ARMI plugin depends on ARMI itself, and a collection of other publicly-available
Python packages. It is recommended to install all of these within a Python virtual
environment. The <a class="reference external" href="https://terrapower.github.io/armi/installation.html" title="(in ARMI v0.1.5)"><span class="xref std std-doc">ARMI Installation Documentation</span></a> provides good
guidance on how to create a virtual environment and install ARMI into it.</p>
<p>In addition to the dependencies needed to make ARMI and the DIF3D plugin run, there are
some optional dependencies that are needed to run the tests and generate these
documents. These extra dependencies are expressed in the <code class="docutils literal notranslate"><span class="pre">dev</span></code> package extras, and can
be installed by appending <code class="docutils literal notranslate"><span class="pre">[dev]</span></code> to the <code class="docutils literal notranslate"><span class="pre">pip</span></code> install target. Examples of this are
shown below.</p>
</div>
<div class="section" id="installing-the-code">
<h3><span class="section-number">4.1.2. </span>Installing the code<a class="headerlink" href="#installing-the-code" title="Permalink to this headline">¶</a></h3>
<p>The plugin is written in pure Python and does not need to be compiled. Once the code
is extracted in a folder, there are several options for installing it. The easiest
way to do this is to install it in “editable” mode; run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>to install it into your virtual environment. The <code class="docutils literal notranslate"><span class="pre">-e</span></code> flag tells <code class="docutils literal notranslate"><span class="pre">pip</span></code> to place a
link to the code in <code class="docutils literal notranslate"><span class="pre">site-packages</span></code>, rather than copying the files themselves.
If it is desired to generate the documentation or run unit tests, the above can be
modified to install the extra dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span><span class="p">[</span><span class="n">dev</span><span class="p">]</span>
</pre></div>
</div>
<p>Alternatively, the code can be packaged and installed. One way to do this is to install
the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> package, build a <a class="reference external" href="https://wheel.readthedocs.io/en/stable/">wheel</a>, and
install that wheel into your environment. The following commands would accomplish this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">wheel</span>
<span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span>
<span class="o">&gt;</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">dist</span><span class="o">/</span><span class="n">inl_dif3d</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
<p>At this point it should be possible to import the DIF3D plugin modules, and to run the
main demonstration application, <code class="docutils literal notranslate"><span class="pre">dif3ddemo</span></code>.</p>
</div>
<div class="section" id="external-physics-codes">
<h3><span class="section-number">4.1.3. </span>External physics codes<a class="headerlink" href="#external-physics-codes" title="Permalink to this headline">¶</a></h3>
<p>In addition to the Python code that makes ARMI and the DIF3D plugin operate, the <a class="reference external" href="https://www.polymtl.ca/merlin/version5.htm">Dragon</a> and <a class="reference external" href="https://www.ne.anl.gov/codes/dif3d/">DIF3D</a> codes will need to be present on the system in
order to actually run them. Obtaining, compiling, and installing these is beyond
the scope of this document. Once installed, it is recommended that they be available via
the system <code class="docutils literal notranslate"><span class="pre">PATH</span></code> to avoid needing to define their precise locations through the
<code class="docutils literal notranslate"><span class="pre">dragonExePath</span></code> and <code class="docutils literal notranslate"><span class="pre">dif3dExePath</span></code> settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DRAGON is used in the demo application to generate multigroup cross sections.
Other lattice physics codes may be used in its place if desired.</p>
</div>
</div>
</div>
<div class="section" id="running-the-test-suite">
<h2><span class="section-number">4.2. </span>Running the test suite<a class="headerlink" href="#running-the-test-suite" title="Permalink to this headline">¶</a></h2>
<div class="section" id="unit-tests">
<h3><span class="section-number">4.2.1. </span>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h3>
<p>The plugin comes with several self-contained unit tests. To run them, execute the
following in the root folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">pytest</span>
</pre></div>
</div>
<p>The tests themselves rely on a handful of <cite>unit test fixtures</cite>, which are essentially
binary and ASCII output files from DIF3D that the units tests operate upon. These are
committed to the source repository, and should already be present. In the event that
they need to be updated, this can be done by running the <code class="docutils literal notranslate"><span class="pre">dif3ddemo</span></code> application with
its <code class="docutils literal notranslate"><span class="pre">make-fixture-suite</span></code> and <code class="docutils literal notranslate"><span class="pre">copy-fixture-files</span></code> entry points. It is recommended to
do this somewhere outside of the main source tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">dif3ddemo</span> <span class="n">make</span><span class="o">-</span><span class="n">fixture</span><span class="o">-</span><span class="n">suite</span>
    <span class="o">--</span><span class="n">dragonDataPath</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dragon</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">draglibendfb8r0SHEM361</span>
    <span class="o">--</span><span class="n">dragonExePath</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dragon</span><span class="o">.</span><span class="n">exe</span>
    <span class="o">--</span><span class="n">dif3dExePath</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dif3d</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>On Windows you may have to eliminate or escape the line breaks to get that to
execute.</p>
</div>
<p>From the same working directory that the test fixture cases were run above, they can be
copied to their appropriate location with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">dif3ddemo</span> <span class="n">copy</span><span class="o">-</span><span class="n">fixture</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<p>This will divine the appropriate target location relative to the <code class="docutils literal notranslate"><span class="pre">dif3ddemo</span></code>
application itself.</p>
</div>
</div>
<div class="section" id="user-settings">
<h2><span class="section-number">4.3. </span>User settings<a class="headerlink" href="#user-settings" title="Permalink to this headline">¶</a></h2>
<p>Many settings can be configured by the user at runtime and are accessible to developers
through the <a class="reference external" href="https://terrapower.github.io/armi/.apidocs/armi.settings.caseSettings.html#armi.settings.caseSettings.Settings" title="(in ARMI v0.1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.settings.caseSettings.Settings</span></code></a> object, which is typically
stored in a variable named <code class="docutils literal notranslate"><span class="pre">cs</span></code>. Interfaces have access to a simulation’s settings
through <code class="docutils literal notranslate"><span class="pre">self.cs</span></code>. <a class="reference internal" href="#table-settings"><span class="std std-numref">Table 4.1</span></a> lists all settings that are provided by the
DIF3D ARMI plugin. Additional settings, <a class="reference external" href="https://terrapower.github.io/armi/user/inputs/settings_report.html" title="(in ARMI v0.1.5)"><span class="xref std std-doc">defined by the ARMI Framework and its
built-in global-flux plugin</span></a> also affect the behavior
of this plugin, as it implements the <a class="reference external" href="https://terrapower.github.io/armi/.apidocs/armi.physics.neutronics.globalFlux.globalFluxInterface.html#armi.physics.neutronics.globalFlux.globalFluxInterface.GlobalFluxInterface" title="(in ARMI v0.1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalFluxInterface</span></code></a>
interface. Of these, the <code class="docutils literal notranslate"><span class="pre">neutronicsKernel</span></code> setting is the most important, as it must be
set to <code class="docutils literal notranslate"><span class="pre">&quot;DIF3D-Nodal&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;DIF3D-FD&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;VARIANT&quot;</span></code> for the interface to be
activated.</p>
<div class="docutils container">
<span id="table-settings"></span><table class="colwidths-given longtable docutils align-default" id="id1">
<caption><span class="caption-number">Table 4.1 </span><span class="caption-text">DIF3D Plugin Settings</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 45%" />
<col style="width: 35%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">asympExtrapOfNodalCalc</span></code></p></td>
<td><div class="line-block">
<div class="line">Perform asymptotic source</div>
<div class="line">extrapolation on the the nodal</div>
<div class="line">outer iterations. Applies to</div>
<div class="line">DIF3D-Nodal and VARIANT.</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">asympExtrapOfOverRelaxCalc</span></code></p></td>
<td><div class="line-block">
<div class="line">Asymptotic source extrapolation of</div>
<div class="line">power iterations used to estimate</div>
<div class="line">the spectral radius of each within</div>
<div class="line">group iteration matrix. Intended</div>
<div class="line">for problems with overrelaxation</div>
<div class="line">factor &gt; 1.8.</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coarseMeshRebalance</span></code></p></td>
<td><div class="line-block">
<div class="line">Sets the coarse-mesh rebalance</div>
<div class="line">acceleration to something other</div>
<div class="line">than the default.</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">d3dMem</span></code></p></td>
<td><div class="line-block">
<div class="line">POINTR container array size in</div>
<div class="line">extended core memory for A.DIF3D</div>
<div class="line">card of DIF3D/REBUS. Max</div>
<div class="line">recommended=159999000</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">24000000</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">d3dMem2</span></code></p></td>
<td><div class="line-block">
<div class="line">POINTR container array size in fast</div>
<div class="line">core memory in REAL*8 words in</div>
<div class="line">A.DIF3D card of DIF3D/REBUS. Max</div>
<div class="line">recommended=40000000</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">40000000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dif3dExePath</span></code></p></td>
<td><div class="line-block">
<div class="line">The path do the DIF3D executable</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">dif3d</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsBurnTime</span></code></p></td>
<td><div class="line-block">
<div class="line">Burn time eps (Cycle length</div>
<div class="line">convergence.  Set to 1.0 if the</div>
<div class="line">cycle length is known.)</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">epsCyclic</span></code></p></td>
<td><div class="line-block">
<div class="line">max relative error in isotope stage</div>
<div class="line">density during cyclics  (0.001)</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.001</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsNdens</span></code></p></td>
<td><div class="line-block">
<div class="line">max relative error in any isotope</div>
<div class="line">in region density (0.001)</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.001</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">erf</span></code></p></td>
<td><div class="line-block">
<div class="line">Error reduction factor to be</div>
<div class="line">achieved by each series of inner</div>
<div class="line">iteration for each group during a</div>
<div class="line">shape calculation in DIF3D/REBUS.</div>
<div class="line">Reduce to 0.01 if dominance ratio</div>
<div class="line">estimate is sporadic, or if</div>
<div class="line">pointwise fission source</div>
<div class="line">convergence is not monotonic.</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.04</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inners</span></code></p></td>
<td><div class="line-block">
<div class="line">XY and Axial partial current sweep</div>
<div class="line">inner iterations. 0 is let DIF3D</div>
<div class="line">pick or use default if can’t pick.</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">listIsotxs</span></code></p></td>
<td><div class="line-block">
<div class="line">list ISOTXS in the DIF3D output</div>
<div class="line">file</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">neglectFis</span></code></p></td>
<td><div class="line-block">
<div class="line">Any pointwise fission source will</div>
<div class="line">be neglected in the pointwise</div>
<div class="line">fission source convergence test if</div>
<div class="line">it is less than this factor times</div>
<div class="line">the RMS fission source in</div>
<div class="line">DIF3D/REBUS</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.001</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">neutronicsOutputsToSave</span></code></p></td>
<td><div class="line-block">
<div class="line">Defines outputs from DIF3D-based</div>
<div class="line">neutronics kernel to be copied from</div>
<div class="line">the fast path to the network drive</div>
<div class="line">for inspection, restarts,</div>
<div class="line">debugging, etc.</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">Input/Output</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nipMem</span></code></p></td>
<td><div class="line-block">
<div class="line">Size of main core storage array for</div>
<div class="line">geometry processing module (GNIP4C)</div>
<div class="line">in A.NIP card of DIF3D/REBUS. Max</div>
<div class="line">recommended=40000000</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">40000000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nodalApproxXY</span></code></p></td>
<td><div class="line-block">
<div class="line">Approximation controls in XY-Plane</div>
<div class="line">(LMN). L can either be 0</div>
<div class="line">(diffusion) or 1 (transport), M is</div>
<div class="line">the flux approximation order (2:</div>
<div class="line">quadratic, 3: cubic, or 4:</div>
<div class="line">quartic), and N is the leakage</div>
<div class="line">approximation order (0: constant or</div>
<div class="line">2: quadratic). For details, see</div>
<div class="line">A.DIF3D file formats document,</div>
<div class="line">under TYPE 10.</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">40</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nodalApproxZ</span></code></p></td>
<td><div class="line-block">
<div class="line">Approximation controls in</div>
<div class="line">Z-direction. M is the flux</div>
<div class="line">approximation order (2: quadratic,</div>
<div class="line">3: cubic, or 4: quartic), and N is</div>
<div class="line">the leakage approximation order (0:</div>
<div class="line">constant or 2: quadratic). For</div>
<div class="line">details, see A.DIF3D file formats</div>
<div class="line">document, under TYPE 10.</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">32</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">outers</span></code></p></td>
<td><div class="line-block">
<div class="line">Max number of outer iterations to</div>
<div class="line">converge</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">useRadialInnerIterationAlgorithm</span></code></p></td>
<td><div class="line-block">
<div class="line">Use the VARIANT Radial Inner</div>
<div class="line">Iteration Algorithm which is</div>
<div class="line">helpful for cases with small node</div>
<div class="line">mesh. Type 12 card in A.DIF3D</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">variantNodalSpatialApproximation</span></code></p></td>
<td><div class="line-block">
<div class="line">The Nodal Spatial polynomial</div>
<div class="line">approximation in VARIANT. See Type</div>
<div class="line">12 card in A.DIF3D for information.</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">20501</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">variantTransportAndScatterOrder</span></code></p></td>
<td><div class="line-block">
<div class="line">The flux/leakage angle and</div>
<div class="line">scattering orders to use with</div>
<div class="line">neutronics kernel VARIANT.</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">writeDif3dDb</span></code></p></td>
<td><div class="line-block">
<div class="line">If enabled, a database will be</div>
<div class="line">created containing the results of</div>
<div class="line">the most recent DIF3D invocation</div>
<div class="line">before converting back to the input</div>
<div class="line">mesh. This is useful for</div>
<div class="line">visualizing/analyzing the direct</div>
<div class="line">results of the DIF3D run without</div>
<div class="line">any mesh conversions taking place.</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xsMem</span></code></p></td>
<td><div class="line-block">
<div class="line">Size of main core storage array for</div>
<div class="line">cross section processing modules.</div>
<div class="line">Max recommended=40000000</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">40000000</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="input-data">
<h2><span class="section-number">4.4. </span>Input Data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h2>
<p>State information required on the ARMI data model before this plugin can operate
includes the following:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">Core</span></code> system populated with <cite>Blocks</cite> that have number-density compositions
(typically provided by user input and/or depletion modules). Any reactor model that is
loaded from an ARMI Blueprints file will contain a <code class="docutils literal notranslate"><span class="pre">.core</span></code> member that functions in
this capacity.</p></li>
<li><p>A microscopic cross section library provided by the user or a lattice physics plugin,
in ISOTXS format. In all of the examples presented, this was produced by the
open-source ARMI <a class="reference external" href="https://github.com/terrapower/dragon-armi-plugin">DRAGON plugin</a>,
which is included in the <code class="docutils literal notranslate"><span class="pre">dif3ddemo</span></code> app. Running the <code class="docutils literal notranslate"><span class="pre">dif3ddemo</span></code> <code class="docutils literal notranslate"><span class="pre">run</span></code> entry
point will lead to the creation of such an ISOTXS file before attempting to run DIF3D.</p></li>
</ul>
</div>
<div class="section" id="output-data">
<h2><span class="section-number">4.5. </span>Output Data<a class="headerlink" href="#output-data" title="Permalink to this headline">¶</a></h2>
<p>The DIF3D plugin writes the DIF3D neutronics results to the ARMI data model on
the following Parameters.</p>
<div class="section" id="core-parameters">
<h3><span class="section-number">4.5.1. </span>Core parameters<a class="headerlink" href="#core-parameters" title="Permalink to this headline">¶</a></h3>
<p>A subset of the core parameters provided by the <a class="reference external" href="https://terrapower.github.io/armi/user/core_parameters_report.html#neutronicsplugin-core-param-table" title="(in ARMI v0.1.5)"><span class="xref std std-ref">generic neutronics plugin</span></a> are written by this plugin.
Specifically:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keff</span></code></p></li>
</ul>
</div>
<div class="section" id="block-parameters">
<h3><span class="section-number">4.5.2. </span>Block parameters<a class="headerlink" href="#block-parameters" title="Permalink to this headline">¶</a></h3>
<p>A subset of the block parameters provided by the <a class="reference external" href="https://terrapower.github.io/armi/user/block_parameters_report.html#neutronicsplugin-block-param-table" title="(in ARMI v0.1.5)"><span class="xref std std-ref">generic neutronics
plugin</span></a> are written by this plugin.
Specifically:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pdens</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppdens</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">power</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flux</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fluxPeak</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mgFlux</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fluxAdj</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">adjMgFlux</span></code></p></li>
</ul>
<p>In addition to the parameters supplied directly from the DIF3D output, several other
flux-derived parameters are also calculated when the DIF3D solution is mapped from the
DIF3D mesh back to the as-input ARMI mesh. Re-calculated values include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rateCap</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rateFis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rateProdN2n</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rateProdFis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rateAbs</span></code></p></li>
</ul>
<p>The exact behavior of the mapped and recalculated parameter values is governed by the
<a class="reference external" href="https://terrapower.github.io/armi/.apidocs/armi.physics.neutronics.globalFlux.globalFluxInterface.html#armi.physics.neutronics.globalFlux.globalFluxInterface.calcReactionRates" title="(in ARMI v0.1.5)"><code class="docutils literal notranslate"><span class="pre">armi.physics.neutronics.globalFlux.globalFluxInterface.calcReactionRates()</span></code></a>
function and
<a class="reference external" href="https://terrapower.github.io/armi/.apidocs/armi.reactor.converters.uniformMesh.html#armi.reactor.converters.uniformMesh.NeutronicsUniformMeshConverter" title="(in ARMI v0.1.5)"><code class="docutils literal notranslate"><span class="pre">armi.reactor.converters.uniformMesh.NeutronicsUniformMeshConverter</span></code></a>
class. This behavior is demonstrated in <a class="reference internal" href="results.html#sec-results"><span class="std std-ref">Results</span></a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="design.html" class="btn btn-neutral float-right" title="5. Requirements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="summary.html" class="btn btn-neutral float-left" title="1. Attribution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, TerraPower, LLC.
      <span class="lastupdated">
        Last updated on 2021-04-09.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>