

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.6. Making your first ARMI-based App &mdash; ARMI 0.1.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/armiicon_16x16.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_fixes.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.7. Parameter sweeps" href="param_sweep.html" />
    <link rel="prev" title="2.5. Hands-on at the ARMI Terminal" href="data_model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ARMI
          

          
            
            <img src="../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../user_install.html">1. Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">2. Guided Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="nuclide_demo.html">2.1. Nuclides and ARMI</a></li>
<li class="toctree-l3"><a class="reference internal" href="materials_demo.html">2.2. The ARMI Material Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="walkthrough_inputs.html">2.3. Building input files for a fast reactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="walkthrough_lwr_inputs.html">2.4. Building input files for a thermal reactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_model.html">2.5. Hands-on at the ARMI Terminal</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.6. Making your first ARMI-based App</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#starting-a-new-app">2.6.1. Starting a new app</a></li>
<li class="toctree-l4"><a class="reference internal" href="#registering-the-app-with-armi">2.6.2. Registering the app with ARMI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-the-app-class">2.6.3. Defining the app class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-the-physics-plugin">2.6.4. Defining the physics plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-physics-kernels">2.6.5. Creating the physics kernels</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-entry-points">2.6.6. Adding entry points</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-app-and-debugging">2.6.7. Running the app and debugging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checking-the-output">2.6.8. Checking the output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="param_sweep.html">2.7. Parameter sweeps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../inputs/index.html">3. Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/index.html">4. Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual_data_access.html">5. Accessing Data in ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reactor_parameters_report.html">6. Reactor Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_parameters_report.html">7. Core Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assembly_parameters_report.html">8. Assembly Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../block_parameters_report.html">9. Block Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assorted_guide.html">10. Branch Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assorted_guide.html#physics-coupling">11. Physics Coupling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../.apidocs/modules.html">API Docs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Guide</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">2. </span>Guided Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">2.6. </span>Making your first ARMI-based App</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user/tutorials/making_your_first_app.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="making-your-first-armi-based-app">
<h1><span class="section-number">2.6. </span>Making your first ARMI-based App<a class="headerlink" href="#making-your-first-armi-based-app" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will build a nuclear analysis application that runs (dummy) neutron
flux and thermal/hydraulics calculations. Applications that do real analysis can be
modeled after this starting point.</p>
<p>We’ll assume you have the <a class="reference internal" href="../user_install.html"><span class="doc">ARMI Framework installed</span></a> already.
You can make sure it is ready by running the following command in a shell prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(armi) $ python -c &quot;import armi;armi.configure()&quot;
</pre></div>
</div>
<p>You should see an ARMI splash-screen and an ARMI version print out. If you do, you are ready
to proceed.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are having trouble getting it installed, see <a class="reference internal" href="../../intro.html#getting-help"><span class="std std-ref">Getting help</span></a>. You may
need to ensure your <code class="docutils literal notranslate"><span class="pre">PYTHON_PATH</span></code> variable includes the armi installation directory.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial is a companion for the <a class="reference internal" href="../../developer/making_armi_based_apps.html"><span class="doc">Making ARMI-based Apps</span></a>
developer documentation.</p>
</div>
<div class="section" id="starting-a-new-app">
<h2><span class="section-number">2.6.1. </span>Starting a new app<a class="headerlink" href="#starting-a-new-app" title="Permalink to this headline">¶</a></h2>
<p>ARMI-based applications can take on many forms, depending on your workflow. Examples may include:</p>
<ul class="simple">
<li><p>Application and plugins together under one folder</p></li>
<li><p>Application in one folder, plugins in separate ones</p></li>
</ul>
<p>We will build an application that contains one plugin that runs
neutronics and thermal hydraulics in one folder. This architecture will be a good starting
point for many projects, and can always be separated if needed.</p>
<p>From the command line, <code class="docutils literal notranslate"><span class="pre">cd</span></code> into a new directory where you’d like to store your
application code. Make a folder structure that works as a <a class="reference external" href="https://packaging.python.org/tutorials/packaging-projects/">normal Python package</a>, and create some empty
files for us to fill in, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_armi_project</span><span class="o">/</span>
    <span class="n">myapp</span><span class="o">/</span>
        <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
        <span class="n">__main__</span><span class="o">.</span><span class="n">py</span>
        <span class="n">app</span><span class="o">.</span><span class="n">py</span>
        <span class="n">plugin</span><span class="o">.</span><span class="n">py</span>
        <span class="n">fluxSolver</span><span class="o">.</span><span class="n">py</span>
        <span class="n">thermalSolver</span><span class="o">.</span><span class="n">py</span>
    <span class="n">setup</span><span class="o">.</span><span class="n">py</span>
    <span class="n">README</span><span class="o">.</span><span class="n">md</span>
    <span class="n">LICENSE</span><span class="o">.</span><span class="n">md</span>
</pre></div>
</div>
<p>These files are:</p>
<ul class="simple">
<li><p>The outer <code class="file docutils literal notranslate"><span class="pre">my_armi_project</span></code> root directory is a container for your app. The name
does not matter to ARMI; you can rename it to anything.</p></li>
<li><p>The inner <code class="file docutils literal notranslate"><span class="pre">myapp</span></code> directory is the actual Python package for your app. Its name is
the Python package name you will use to import anything inside (e.g. <code class="docutils literal notranslate"><span class="pre">myapp.plugin</span></code>).</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">myapp/__init__.py</span></code> tells Python that this directory is a Python package and
registers the application with the ARMI framework.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">myapp/__main__.py</span></code> provides one or more entry points for users of your app
(including you!) to start running it.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">myapp/app.py</span></code> contains the actual app registration code that will be called by
<code class="file docutils literal notranslate"><span class="pre">__init__.py</span></code>. This can be named anything as long as it is consistent with the
registration code in <code class="file docutils literal notranslate"><span class="pre">myapp/__init__.py</span></code>.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">myapp/plugin.py</span></code> contains the code that defines the physics plugin we will create</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">myapp/fluxSolver.py</span></code> contains the flux solver</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">myapp/thermalSolver.py</span></code> contains the thermal/hydraulics solver</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> the <a class="reference external" href="https://docs.python.org/3/distutils/setupscript.html">python package installation file</a> to help users install your
application.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">README.md</span></code> and <code class="file docutils literal notranslate"><span class="pre">LICENSE.md</span></code> are an optional description and license of your
application that would be prominently featured, e.g. in a github repo, if you were to
put it there.</p></li>
</ul>
</div>
<div class="section" id="registering-the-app-with-armi">
<h2><span class="section-number">2.6.2. </span>Registering the app with ARMI<a class="headerlink" href="#registering-the-app-with-armi" title="Permalink to this headline">¶</a></h2>
<p>The ARMI Framework contains features to run the “main loop” of typical applications. In
order to get access to these, we must register our new app with the ARMI framework. To do
this, we put the following code in the top-level <code class="file docutils literal notranslate"><span class="pre">__init__.py</span></code> module:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/__init__.py</span></code></span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">armi</span>
<span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">app</span>
<span class="n">armi</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">ExampleApp</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="defining-the-app-class">
<h2><span class="section-number">2.6.3. </span>Defining the app class<a class="headerlink" href="#defining-the-app-class" title="Permalink to this headline">¶</a></h2>
<p>We define our app in the <code class="file docutils literal notranslate"><span class="pre">myapp/app.py</span></code> module. For this example, the app class is
relatively small: it will just register our one custom plugin. We will actually create
the plugin shortly.</p>
<div class="admonition-apps-vs-plugins-vs-interfaces admonition">
<p class="admonition-title">Apps vs. plugins vs. interfaces</p>
<p>ARMI-based methodologies are broken down into three layers of abstraction. Apps are
collections of plugins intended to perform analysis on a certain type of reactor.
Plugins are independent and mixable collections of relatively arbitrary code that
might bring in special materials, contain certain engineering methodologies, and/or
Interfaces with one or more physics kernels. See <a class="reference internal" href="../../developer/guide.html"><span class="doc">Framework Architecture</span></a> for more
info on architecture.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/app.py</span></code></span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">armi</span>
<span class="kn">from</span> <span class="nn">armi.apps</span> <span class="kn">import</span> <span class="n">App</span>

<span class="kn">from</span> <span class="nn">myapp.plugin</span> <span class="kn">import</span> <span class="n">DummyPhysicsPlugin</span>

<span class="k">class</span> <span class="nc">ExampleApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># activate all built-in plugins</span>
        <span class="n">App</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># register our plugin with the plugin manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pm</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">DummyPhysicsPlugin</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">splashText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;** My Example App **&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="defining-the-physics-plugin">
<h2><span class="section-number">2.6.4. </span>Defining the physics plugin<a class="headerlink" href="#defining-the-physics-plugin" title="Permalink to this headline">¶</a></h2>
<p>Now we will create the plugin that will coordinate our dummy physics modules.</p>
<div class="admonition-what-are-plugins-again admonition">
<p class="admonition-title">What are plugins again?</p>
<p>Plugins are the basic modular building block of ARMI-based apps. In some cases, one
plugin will be associated with one physics kernel (like COBRA or MCNP). This is a
reasonable practice when you expect to be mixing and matching various combinations of
plugins between related teams. It is also possible to have a plugin that performs a
whole cacophony of analyses using multiple codes, which some smaller research teams
may find preferable. The flexibility is very broad.</p>
<p>See <a class="reference internal" href="../../.apidocs/armi.plugins.html#module-armi.plugins" title="armi.plugins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">armi.plugins</span></code></a> more for info.</p>
</div>
<p>Plugin code can exist in any directory structure in an app. In this app we
put it in the <code class="file docutils literal notranslate"><span class="pre">myapp/plugin.py</span></code> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For “serious” plugins, we recommend mirroring the <code class="docutils literal notranslate"><span class="pre">armi/physics/[subphysics]</span></code>
structure of the ARMI framework <a class="reference internal" href="../../.apidocs/armi.physics.html#module-armi.physics" title="armi.physics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">physics</span> <span class="pre">plugin</span> <span class="pre">subpackage</span></code></a>.</p>
</div>
<p>We will start the plugin by pointing to the two physics kernels we wish to register. We
hook them in and tell ARMI the <code class="docutils literal notranslate"><span class="pre">ORDER</span></code> they should be run in based on the built-in
<code class="docutils literal notranslate"><span class="pre">STACK_ORDER</span></code> attribute (defined and discussed <a class="reference internal" href="../../.apidocs/armi.interfaces.html#armi.interfaces.STACK_ORDER" title="armi.interfaces.STACK_ORDER"><code class="xref py py-class docutils literal notranslate"><span class="pre">here</span></code></a>).  We will come back to this plugin definition later on to
add a little more to the plugin.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/plugin.py</span></code></span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">plugins</span>
<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">interfaces</span>
<span class="kn">from</span> <span class="nn">armi.interfaces</span> <span class="kn">import</span> <span class="n">STACK_ORDER</span> <span class="k">as</span> <span class="n">ORDER</span>

<span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">fluxSolver</span>
<span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">thermalSolver</span>


<span class="k">class</span> <span class="nc">DummyPhysicsPlugin</span><span class="p">(</span><span class="n">plugins</span><span class="o">.</span><span class="n">ArmiPlugin</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="nd">@plugins.HOOKIMPL</span>
    <span class="k">def</span> <span class="nf">exposeInterfaces</span><span class="p">(</span><span class="n">cs</span><span class="p">):</span>
        <span class="n">kernels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">interfaces</span><span class="o">.</span><span class="n">InterfaceInfo</span><span class="p">(</span><span class="n">ORDER</span><span class="o">.</span><span class="n">FLUX</span><span class="p">,</span> <span class="n">fluxSolver</span><span class="o">.</span><span class="n">FluxInterface</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="n">interfaces</span><span class="o">.</span><span class="n">InterfaceInfo</span><span class="p">(</span><span class="n">ORDER</span><span class="o">.</span><span class="n">THERMAL_HYDRAULICS</span><span class="p">,</span> <span class="n">thermalSolver</span><span class="o">.</span><span class="n">ThermalInterface</span><span class="p">,</span> <span class="p">{}),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">kernels</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-the-physics-kernels">
<h2><span class="section-number">2.6.5. </span>Creating the physics kernels<a class="headerlink" href="#creating-the-physics-kernels" title="Permalink to this headline">¶</a></h2>
<p>So far we have basically been weaving an administrative thread to tell ARMI about the code
we want to run. Now we finally get to write the guts of the code that actually does
something. In your real app, this code will run your own industrial or research code, or
perform your own methodology.  Here we just have it make up dummy values representing flux
and temperatures.</p>
<div class="section" id="making-the-dummy-flux-kernel">
<h3><span class="section-number">2.6.5.1. </span>Making the dummy flux kernel<a class="headerlink" href="#making-the-dummy-flux-kernel" title="Permalink to this headline">¶</a></h3>
<p>In a previous tutorial, we made a function that sets a dummy flux to all parts of the core
based on a radial distance from the origin. Here we will re-use that code but package it
more formally so that ARMI can actually run it for us from a user perspective.</p>
<p>The interface is responsible largely for scheduling activities to run at various time
points. For a flux calculation, we want it to compute at every single time node, so we use
the <a class="reference internal" href="../../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactEveryNode" title="armi.interfaces.Interface.interactEveryNode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.interfaces.Interface.interactEveryNode()</span></code></a> hook.</p>
<p>These interaction hooks can call arbitrarily complex code. The code could, for example:</p>
<ul class="simple">
<li><p>Run an external executable locally</p></li>
<li><p>Submit an external code to a cloud HPC and wait for it to complete</p></li>
<li><p>Run an internal physics tool</p></li>
</ul>
<p>Here it just a tiny bit of math locally.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/fluxSolver.py</span></code></span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>
<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">interfaces</span>
<span class="kn">from</span> <span class="nn">armi.physics</span> <span class="kn">import</span> <span class="n">neutronics</span>


<span class="k">class</span> <span class="nc">FluxInterface</span><span class="p">(</span><span class="n">interfaces</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dummyFlux&quot;</span>

    <span class="k">def</span> <span class="nf">interactEveryNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cycle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timeNode</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing neutron flux and power.&quot;</span><span class="p">)</span>
        <span class="n">setFakePower</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">core</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">setFakePower</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
    <span class="n">midplane</span> <span class="o">=</span> <span class="n">core</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getHeight</span><span class="p">()</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">midplane</span><span class="p">])</span>
    <span class="n">peakPower</span> <span class="o">=</span> <span class="mf">1e6</span>
    <span class="n">mgFluxBase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">core</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">vol</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">spatialLocator</span><span class="o">.</span><span class="n">getGlobalCoordinates</span><span class="p">()</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">coords</span><span class="o">-</span><span class="n">center</span><span class="p">))</span>
            <span class="n">fuelFlag</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">isFuel</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
            <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">peakPower</span> <span class="o">/</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fuelFlag</span>
            <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pdens</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">power</span><span class="o">/</span><span class="n">vol</span>
            <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">mgFlux</span> <span class="o">=</span> <span class="n">mgFluxBase</span><span class="o">*</span><span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pdens</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="making-the-thermal-hydraulics-kernel">
<h3><span class="section-number">2.6.5.2. </span>Making the thermal/hydraulics kernel<a class="headerlink" href="#making-the-thermal-hydraulics-kernel" title="Permalink to this headline">¶</a></h3>
<p>Since we told the ARMI plugin to schedule the flux solver before thermal/hydraulics solver
via the <code class="docutils literal notranslate"><span class="pre">ORDER</span></code> attribute, we can depend on there being up-to-date block-level <code class="docutils literal notranslate"><span class="pre">power</span></code>
state data loaded onto the ARMI reactor by the time this thermal/hydraulics solver gets
called by the ARMI main loop.</p>
<p>We’ll make a somewhat meaningful (but still totally academic) flow solver here that uses
energy conservation to determine an idealized coolant flow rate. To do this it will
compute the total power produced by each assembly to get the required mass flow rate and
then apply that mass flow rate from the bottom of the assembly to the top, computing a
block-level temperature (and flow velocity) distribution as we go.</p>
<div class="math notranslate nohighlight">
\[q''' = \dot{m} C_p \Delta T\]</div>
<div class="admonition-refactoring-alert admonition">
<p class="admonition-title">Refactoring alert</p>
<p>We set some thermal/hydraulic-related state parameters in the code below. These are
supposed to be defined in the framework-level <a class="reference internal" href="../../.apidocs/armi.physics.thermalHydraulics.html#module-armi.physics.thermalHydraulics" title="armi.physics.thermalHydraulics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">thermal/hydraulic</span> <span class="pre">plugin</span></code></a> but are currently defined <a class="reference internal" href="../../.apidocs/armi.reactor.blockParameters.html#module-armi.reactor.blockParameters" title="armi.reactor.blockParameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">elsewhere</span></code></a>. This is a transitory state; they will be moved soon.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/thermalSolver.py</span></code></span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">interfaces</span>
<span class="kn">from</span> <span class="nn">armi.reactor.flags</span> <span class="kn">import</span> <span class="n">Flags</span>
<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>

<span class="c1"># hard coded inlet/outlet temperatures</span>
<span class="c1"># NOTE: can make these user settings</span>
<span class="n">inletInC</span> <span class="o">=</span> <span class="mf">360.0</span>
<span class="n">outletInC</span> <span class="o">=</span> <span class="mf">520.0</span>

<span class="k">class</span> <span class="nc">ThermalInterface</span><span class="p">(</span><span class="n">interfaces</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dummyTH&quot;</span>

    <span class="k">def</span> <span class="nf">interactEveryNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cycle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timeNode</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing idealized flow rate&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">assembly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">core</span><span class="p">:</span>
            <span class="n">runThermalHydraulics</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">runThermalHydraulics</span><span class="p">(</span><span class="n">assembly</span><span class="p">):</span>
    <span class="n">massFlow</span> <span class="o">=</span> <span class="n">computeIdealizedFlow</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
    <span class="n">computeAxialCoolantTemperature</span><span class="p">(</span><span class="n">assembly</span><span class="p">,</span> <span class="n">massFlow</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">computeIdealizedFlow</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>

    <span class="c1"># compute required mass flow rate in assembly to reach target outlet temperature</span>
    <span class="c1"># mass flow rate will be constant in each axial region, regardless of coolant</span>
    <span class="c1"># area (velocity may change)</span>
    <span class="n">coolants</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getComponents</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">COOLANT</span><span class="p">)</span>
    <span class="n">coolantMass</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">getMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coolants</span><span class="p">])</span>

    <span class="c1"># use ARMI material library to get heat capacity for whatever the user has</span>
    <span class="c1"># defined the coolant as</span>
    <span class="n">tempAvg</span> <span class="o">=</span> <span class="p">(</span><span class="n">outletInC</span> <span class="o">+</span> <span class="n">inletInC</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">coolantProps</span> <span class="o">=</span> <span class="n">coolants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span>
    <span class="n">heatCapacity</span> <span class="o">=</span> <span class="n">coolantProps</span><span class="o">.</span><span class="n">heatCapacity</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">tempAvg</span><span class="p">)</span>

    <span class="n">deltaT</span> <span class="o">=</span> <span class="n">outletInC</span> <span class="o">-</span> <span class="n">inletInC</span>
    <span class="n">massFlowRate</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">calcTotalParam</span><span class="p">(</span><span class="s1">&#39;power&#39;</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">deltaT</span> <span class="o">*</span> <span class="n">heatCapacity</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">massFlowRate</span>

<span class="k">def</span> <span class="nf">computeAxialCoolantTemperature</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">massFlow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute block-level coolant inlet/outlet/avg temp and velocity.&quot;&quot;&quot;</span>
    <span class="c1"># solve q&#39;&#39;&#39; = mdot * Cp * dT for dT this time</span>
    <span class="n">inlet</span> <span class="o">=</span> <span class="n">inletInC</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">THcoolantInletT</span> <span class="o">=</span> <span class="n">inlet</span>
        <span class="n">coolant</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponent</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">COOLANT</span><span class="p">)</span>
        <span class="n">coolantProps</span> <span class="o">=</span> <span class="n">coolant</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span>
        <span class="n">heatCapacity</span> <span class="o">=</span> <span class="n">coolantProps</span><span class="o">.</span><span class="n">heatCapacity</span><span class="p">(</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">inlet</span><span class="p">)</span>
        <span class="n">deltaT</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">power</span><span class="o">/</span><span class="p">(</span><span class="n">massFlow</span> <span class="o">*</span> <span class="n">heatCapacity</span><span class="p">)</span>
        <span class="n">outlet</span> <span class="o">=</span> <span class="n">inlet</span> <span class="o">+</span> <span class="n">deltaT</span>
        <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">THcoolantOutletT</span> <span class="o">=</span> <span class="n">outlet</span>
        <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">THcoolantAverageT</span> <span class="o">=</span> <span class="p">(</span><span class="n">outlet</span> <span class="o">+</span> <span class="n">inlet</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="c1"># fun fact: could iterate on this to get</span>
        <span class="c1"># heat capacity properties updated better</span>
        <span class="c1"># get flow velocity too</span>
        <span class="c1"># V [m/s] = mdot [kg/s] / density [kg/m^3] / area [m^2]</span>
        <span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">THaveCoolantVel</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">massFlow</span> <span class="o">/</span>
            <span class="n">coolantProps</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">THcoolantAverageT</span><span class="p">)</span> <span class="o">/</span>
            <span class="n">coolant</span><span class="o">.</span><span class="n">getArea</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="o">**</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="n">inlet</span><span class="o">=</span><span class="n">outlet</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="adding-entry-points">
<h2><span class="section-number">2.6.6. </span>Adding entry points<a class="headerlink" href="#adding-entry-points" title="Permalink to this headline">¶</a></h2>
<p>In order to call our application directly, we need to add the <code class="file docutils literal notranslate"><span class="pre">__main__.py</span></code> file to
the package. We could add all manner of <a class="reference internal" href="../../.apidocs/armi.cli.entryPoint.html#module-armi.cli.entryPoint" title="armi.cli.entryPoint"><code class="xref py py-mod docutils literal notranslate"><span class="pre">entry</span> <span class="pre">points</span></code></a> here
for different operations we want our application to perform. For now, we can just inherit
from the default ARMI entry points (including <code class="docutils literal notranslate"><span class="pre">run</span></code>) by adding the following code:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/__main__.py</span></code></span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">armi.cli</span> <span class="kn">import</span> <span class="n">ArmiCLI</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">ArmiCLI</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-app-and-debugging">
<h2><span class="section-number">2.6.7. </span>Running the app and debugging<a class="headerlink" href="#running-the-app-and-debugging" title="Permalink to this headline">¶</a></h2>
<p>We are now ready to execute our application. Even though it still contains an issue, we
will run it now to get a feel for the iterative debugging process (sometimes lovingly
called ARMI whack-a-mole).</p>
<p>We must make sure our <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> contains both the armi framework itself as well as
the directory that contains our app. For testing, an example value for this might be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export PYTHONPATH=/path/to/armi:/path/to/my_armi_project
</pre></div>
</div>
<div class="admonition-windows-tip admonition">
<p class="admonition-title">Windows tip</p>
<p>If you’re using Windows, the slashes will be the other way, you use <code class="docutils literal notranslate"><span class="pre">set</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">export</span></code>, and you use <code class="docutils literal notranslate"><span class="pre">;</span></code> to separate entries (or just use the GUI).</p>
</div>
<p>Make a run directory with some input files in it. You can use the same SFR input files
we’ve used in previous tutorials for starters (but quickly transition to your own inputs
for your own interests!)</p>
<p>Here are the files you can download into the run directory.</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../../_downloads/b23bcb418ace18ad8b841459ae614fc7/anl-afci-177-blueprints.yaml"><code class="xref download docutils literal notranslate"><span class="pre">Blueprints</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/b424cee92a451c7f40fbae65db01c396/anl-afci-177.yaml"><code class="xref download docutils literal notranslate"><span class="pre">Settings</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/b5b47fcc2989e42ac9cb8bb18cae2aae/anl-afci-177-coreMap.yaml"><code class="xref download docutils literal notranslate"><span class="pre">Core</span> <span class="pre">map</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/2ae2eee565054bc472f79fd77c653b52/anl-afci-177-fuelManagement.py"><code class="xref download docutils literal notranslate"><span class="pre">Fuel</span> <span class="pre">management</span></code></a></p></li>
</ul>
<p>Then, run your app!:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(armi) $ python -m myapp run anl-afci-177.yaml
</pre></div>
</div>
<p>The code will run for a while and you will see your physics plugins in the interface
stack, but will run into an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">NotImplementedError</span><span class="p">:</span> <span class="n">Material</span> <span class="n">Sodium</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">implement</span> <span class="n">heatCapacity</span>
</pre></div>
</div>
<p>The included academic Sodium material in the ARMI material library doesn’t have any heat
capacity! Here we can either submit a PR adding it to the ARMI Framework (preferred for generic
things), or make our own material and register it through the plugin.</p>
<div class="admonition-yet-another-way admonition">
<p class="admonition-title">Yet another way</p>
<p>You could alternatively make a totally new plugin that only has your team’s special
material properties.</p>
</div>
<div class="section" id="adding-a-new-material">
<h3><span class="section-number">2.6.7.1. </span>Adding a new material<a class="headerlink" href="#adding-a-new-material" title="Permalink to this headline">¶</a></h3>
<p>Let’s just add a subclass of sodium in our plugin that has a heat capacity defined. Make
your new material in a new module called <code class="file docutils literal notranslate"><span class="pre">myapp/materials.py</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">myapp/materials.py</span></code></span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">materials</span>
<span class="kn">from</span> <span class="nn">armi.utils.units</span> <span class="kn">import</span> <span class="n">getTc</span>

<span class="k">class</span> <span class="nc">Sodium</span><span class="p">(</span><span class="n">materials</span><span class="o">.</span><span class="n">Sodium</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">heatCapacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sodium heat capacity in J/kg-K&quot;&quot;&quot;</span>
        <span class="n">Tc</span> <span class="o">=</span> <span class="n">getTc</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span><span class="n">Tk</span><span class="p">)</span>
        <span class="c1"># not even temperature dependent for now</span>
        <span class="k">return</span> <span class="mf">1.252</span>
</pre></div>
</div>
</div>
<p>But wait! Now there are <strong>two</strong> materials with the name <em>Sodium</em> in ARMI. Which will be
chosen? ARMI uses a namespace order controlled by
<a class="reference internal" href="../../.apidocs/armi.materials.html#armi.materials.setMaterialNamespaceOrder" title="armi.materials.setMaterialNamespaceOrder"><code class="xref py py-func docutils literal notranslate"><span class="pre">armi.materials.setMaterialNamespaceOrder()</span></code></a> which can be set either
programmatically (in an app) or at runtime (via the <code class="docutils literal notranslate"><span class="pre">materialNamespaceOrder</span></code> user
setting). In our case, we want to set it at the app level, so we will add the following to
the <code class="file docutils literal notranslate"><span class="pre">myapp/__init__.py</span></code> file:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Addition to <code class="docutils literal notranslate"><span class="pre">myapp/__init__.py</span></code></span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">materials</span>
<span class="n">materials</span><span class="o">.</span><span class="n">setMaterialNamespaceOrder</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;myapp.materials&quot;</span><span class="p">,</span> <span class="s2">&quot;armi.materials&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now ARMI should find our new updated Sodium material and get past that error.  Run it once
again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(armi) $ python -m myapp run anl-afci-177.yaml
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may want to pipe the output to a log file for convenient viewing with
a command like <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">myapp</span> <span class="pre">run</span> <span class="pre">anl-afci-177.yaml</span> <span class="pre">&gt;</span> <span class="pre">run.stdout</span></code></p>
</div>
</div>
</div>
<div class="section" id="checking-the-output">
<h2><span class="section-number">2.6.8. </span>Checking the output<a class="headerlink" href="#checking-the-output" title="Permalink to this headline">¶</a></h2>
<p>Several output files should have been created in the run directory from that past command.
Most important is the <code class="docutils literal notranslate"><span class="pre">anl-afci-177.h5</span></code> HDF5 binary database file. You can use this file
to bring the ARMI state back to any state point from the run for analysis.</p>
<div class="admonition-is-there-a-general-db-viewer admonition">
<p class="admonition-title">Is there a general DB viewer?</p>
<p>TerraPower uses an internal HDF5 viewer called <em>XTVIEW</em> to view the state in the HDF5
database. At some point this tool will either be made available, or we or someone else
will create a plugin for a more generic visualization tools like VisIT or Paraview.
For now you are stuck exploring the HDF5 output via the ARMI API.</p>
</div>
<p>A generic description of the outputs is provided in <a class="reference internal" href="../outputs/index.html"><span class="doc">Outputs</span></a>.</p>
<p>You can add your own outputs from your plugins.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="param_sweep.html" class="btn btn-neutral float-right" title="2.7. Parameter sweeps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="data_model.html" class="btn btn-neutral float-left" title="2.5. Hands-on at the ARMI Terminal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2020, TerraPower, LLC
      <span class="lastupdated">
        Last updated on 2020-06-25.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>